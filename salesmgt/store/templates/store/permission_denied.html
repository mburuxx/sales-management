{% extends "store/base.html" %}
{% load static %}

{% block title %}Access Denied{% endblock title %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-7 col-lg-6">
            <div class="card text-center shadow-lg border-0 rounded-3 p-5">
                <div class="card-body">
                    
                    <!-- Lock Icon -->
                    <i class="fa-solid fa-lock fa-4x mb-4" style="color: #dc3545;"></i>
                    
                    <h1 class="display-5 text-danger mb-3">Access Denied</h1>
                    
                    <!-- Display the custom message passed from the view (ProductUpdateView) -->
                    <p class="lead text-muted">{{ message }}</p>
                    
                    <hr>
                    
                    <p class="mt-4">
                        You will be automatically redirected to the 
                        <a href="{{ redirect_url }}" style="color: var(--primary-color);">Dashboard</a> 
                        in <span id="countdown">{{ redirect_delay }}</span> seconds.
                    </p>
                    
                    <!-- Manual button for quick redirect -->
                    <a href="{{ redirect_url }}" class="btn btn-primary btn-lg rounded-pill mt-3">Go to Dashboard Now</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Get the redirect URL and delay from the Django context
    const redirectUrl = "{{ redirect_url }}";
    let redirectDelay = parseInt("{{ redirect_delay }}"); // Seconds
    const countdownElement = document.getElementById('countdown');

    // Function to update countdown timer
    function updateCountdown() {
        if (redirectDelay > 0) {
            redirectDelay--;
            countdownElement.textContent = redirectDelay;
        }
    }
    
    // Start countdown immediately and update every second
    const countdownInterval = setInterval(updateCountdown, 1000);

    // Set the timeout for automatic redirection
    setTimeout(() => {
        clearInterval(countdownInterval); // Stop the countdown
        window.location.href = redirectUrl;
    }, redirectDelay * 1000);
</script>
{% endblock content %}
